### What is WannaCry 
WannaCry is a ransomware cryptoworm, which targeted computers running the Microsoft Windows operating system by encrypting (locking) data and demanding ransom payments in the Bitcoin cryptocurrency. The worm is also known as WannaCrypt,Wana Decrypt0r 2.0,WanaCrypt0r 2.0,and Wanna Decryptor.It is considered a network worm because it also includes a transport mechanism to automatically spread itself. This transport code scans for vulnerable systems, then uses the EternalBlue exploit to gain access, and the DoublePulsar tool to install and execute a copy of itself. WannaCry versions 0, 1, and 2 were created using Microsoft Visual C++ 6.0.

EternalBlue is an exploit of Microsoft's implementation of their Server Message Block (SMB) protocol released by The Shadow Brokers. Much of the attention and comment around the event was occasioned by the fact that the U.S. National Security Agency (NSA) (from whom the exploit was likely stolen) had already discovered the vulnerability, but used it to create an exploit for its own offensive work, rather than report it to Microsoft. Microsoft eventually discovered the vulnerability, and on Tuesday, 14 March 2017, they issued security bulletin MS17-010, which detailed the flaw and announced that patches had been released for all Windows versions that were currently supported at that time, these being Windows Vista, Windows 7, Windows 8.1, Windows 10, Windows Server 2008, Windows Server 2008 R2, Windows Server 2012, and Windows Server 2016.

### Working of WannaCry

When executed, the WannaCry malware first checks the kill switch domain name; if it is not found, then the ransomware encrypts the computer's data,then attempts to exploit the SMB vulnerability to spread out to random computers on the Internet, and laterally to computers on the same network. As with other modern ransomware, the payload displays a message informing the user that their files have been encrypted, and demands a payment of around US$300 in bitcoin within three days, or US$600 within seven days,warning that "you have not so enough time." Three hardcoded bitcoin addresses, or wallets, are used to receive the payments of victims. As with all such wallets, their transactions and balances are publicly accessible even though the cryptocurrency wallet owners remain unknown.

Several organizations released detailed technical write-ups of the malware, including a senior security analyst at RiskSense, Microsoft, Cisco,Malwarebytes,Symantec and McAfee.

### Detailed Methodology
The threat arrives as a dropper Trojan that has the following two components:

1.  A component that attempts to exploit the SMB CVE-2017-0145 vulnerability in other computers
2.  The ransomware known as WannaCrypt

The dropper tries to connect the following domains using the _API InternetOpenUrlA()_:

www[.]iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com
www[.]ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.com
www[.]iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.test


If connection to the domains is successful, the dropper does not infect the system further with ransomware or try to exploit other systems to spread; it simply stops execution. However, if the connection fails, the threat proceeds to drop the ransomware and creates a service on the system.

The threat creates a service named mssecsvc2.0, whose function is to exploit the SMB vulnerability in other computers accessible from the infected system:

Service Name: mssecsvc2.0
Service Description: (Microsoft Security Center (2.0) Service)
Service Parameters: “-m security”


WannaCrypt encrypts all files it finds and renames them by appending _.WNCRY_ to the file name. For example, if a file is named _picture.jpg_, the ransomware encrypts and renames the file to _picture.jpg.WNCRY_.

This ransomware also creates the file _@Please_Read_Me@.txt_ in every folder where files are encrypted. The file contains the same ransom message shown in the replaced wallpaper image

It also runs an executable showing a ransom note which indicates a $300 ransom in Bitcoins as well as a timer.


#### Speading Capability
The worm functionality attempts to infect unpatched Windows machines in the local network. At the same time, it also executes massive scanning on Internet IP addresses to find and infect other vulnerable computers



### Protection Against the WannaCry attack

To get the latest protection from Microsoft, upgrade to Windows 10. Keeping your computers up-to-date gives you the benefits of the latest features and proactive mitigations built into the latest versions of Windows.


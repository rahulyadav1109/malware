/*
   YARA Rule Set
   Author: Rahul Yadav
   Date: 2022-05-15
   Identifier: Snake_Keylogger
   Reference: https://github.com/Neo23x0/yarGen
*/

/* Rule Set ----------------------------------------------------------------- */

rule Snake_keylogger {
   meta:
      description = "Snake_Keylogger - file a5c79f588a44e4af09030ec4ff2c0dfadd1d5ac7158903cdef67d8476c422d09"
      author = "Rahul Yadav"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2022-05-15"
      hash1 = "a5c79f588a44e4af09030ec4ff2c0dfadd1d5ac7158903cdef67d8476c422d09"
   strings:
      $s1 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s2 = "eeeee.exe" fullword wide
      $s3 = "EXEC SP_COMMON_GETPARTINV '" fullword wide
      $s4 = "4System.Web.Services.Protocols.SoapHttpClientProtocol" fullword ascii
      $s5 = "exec KSP_FRMOPENRA_GETSUMMARY '" fullword wide
      $s6 = "        <requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"/>" fullword ascii
      $s7 = "EXEC SP_COMMON_LOTSAVE '" fullword wide
      $s8 = "exec SP_COMMON_WKRESULT '" fullword wide
      $s9 = "EXEC SP_COMMON_LOTCREATE '" fullword wide
      $s10 = "PartNo is not exist!!!" fullword wide
      $s11 = "EXEC SP_FRMMODELMST_SAVE '" fullword wide
      $s12 = "EXEC SP_FRMMODIFYPO '" fullword wide
      $s13 = "EXEC SP_FRMMODIFYPO_INS '" fullword wide
      $s14 = "MyTemplate" fullword ascii
      $s15 = "My.Computer" fullword ascii
      $s16 = "  <assemblyIdentity version=\"1.0.0.0\" name=\"MyApplication.app\"/>" fullword ascii
      $s17 = ".NET Framework 4.5)" fullword ascii
      $s18 = "System.Windows.Forms.Form" fullword ascii
      $s19 = "/;>.% 7C+," fullword ascii /* hex encoded string '|' */
      $s20 = "4?)5*71\"{" fullword ascii /* hex encoded string 'Eq' */
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}
